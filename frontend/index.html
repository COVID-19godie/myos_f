<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZMG Cloud OS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <style>
        /* ================= æ ¸å¿ƒå˜é‡ä¸é‡ç½® ================= */
        :root {
            --glass-bg: rgba(255, 255, 255, 0.65);
            --glass-border: rgba(255, 255, 255, 0.4);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            --backdrop-blur: blur(12px);
            --accent-color: #007aff;
            --text-color: #333;
            --win-header-h: 40px;
        }

        * { box-sizing: border-box; user-select: none; outline: none; }
        body { 
            margin: 0; overflow: hidden; font-family: "Segoe UI", "Microsoft YaHei", sans-serif; 
            background-color: #333;
            background-size: cover; background-position: center; transition: background 0.5s;
        }

        /* åŠ¨æ€å£çº¸é®ç½© (è®©æ–‡å­—æ›´æ¸…æ™°) */
        body::before {
            content: ''; position: absolute; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.1); z-index: 0; pointer-events: none;
        }

        /* ================= æ¡Œé¢å›¾æ ‡ç³»ç»Ÿ ================= */
        #desktop { position: fixed; top: 0; left: 0; width: 100%; height: calc(100% - 80px); padding: 10px; z-index: 1; }
        .icon-grid { 
            display: flex; flex-direction: column; flex-wrap: wrap; 
            height: 100%; align-content: flex-start; gap: 15px; 
        }
        
        .icon {
            width: 90px; display: flex; flex-direction: column; align-items: center; 
            cursor: pointer; padding: 5px; border-radius: 8px; transition: 0.2s; position: relative;
        }
        .icon:hover { background: rgba(255,255,255,0.2); backdrop-filter: blur(5px); }
        .icon:active { transform: scale(0.95); }
        
        .icon-body {
            width: 64px; height: 64px; display: flex; align-items: center; justify-content: center;
            background: rgba(255,255,255,0.9); border-radius: 14px; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); font-size: 32px; overflow: hidden; position: relative;
        }
        /* è§†é¢‘/å›¾ç‰‡ç¼©ç•¥å›¾è¦†ç›– */
        .icon-thumb { width: 100%; height: 100%; object-fit: cover; }

        .icon-text {
            margin-top: 6px; font-size: 13px; color: white; text-align: center; 
            text-shadow: 0 1px 3px rgba(0,0,0,0.8); width: 100%; 
            overflow: hidden; white-space: nowrap; text-overflow: ellipsis; padding: 2px 4px;
        }

        /* ================= ç°ä»£åŒ–çª—å£ç³»ç»Ÿ ================= */
        .window {
            position: absolute; 
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            -webkit-backdrop-filter: var(--backdrop-blur);
            border: 1px solid var(--glass-border);
            border-radius: 10px; 
            box-shadow: var(--glass-shadow);
            display: flex; flex-direction: column; overflow: hidden; 
            min-width: 300px; min-height: 200px;
            opacity: 0; transform: scale(0.95); transition: opacity 0.2s, transform 0.2s, width 0.3s, height 0.3s, top 0.3s, left 0.3s;
        }
        .window.open { opacity: 1; transform: scale(1); }
        .window.minimized { 
            opacity: 0; transform: scale(0.5) translateY(500px); pointer-events: none; 
        }

        .win-header {
            height: var(--win-header-h); background: rgba(255,255,255,0.4); 
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 15px; cursor: move; border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .win-title { font-weight: 600; font-size: 14px; color: #333; pointer-events: none;}
        
        /* Windows é£æ ¼æ§åˆ¶æŒ‰é’® */
        .win-controls { display: flex; gap: 0; height: 100%; align-items: center; }
        .win-btn { 
            width: 36px; height: 100%; border: none; background: transparent; 
            font-size: 14px; color: #555; cursor: pointer; transition: 0.2s;
            display: flex; align-items: center; justify-content: center;
        }
        .win-btn:hover { background: rgba(0,0,0,0.1); }
        .btn-close:hover { background: #ff4d4f; color: white; }

        .win-body { flex: 1; position: relative; display: flex; overflow: hidden; background: rgba(255,255,255,0.8); }

        /* ä¾§è¾¹æ æ ·å¼ */
        .win-sidebar { 
            width: 200px; background: rgba(0,0,0,0.05); 
            border-right: 1px solid rgba(0,0,0,0.1); 
            overflow-y: auto; padding: 10px 0;
        }
        .sidebar-item { 
            padding: 8px 15px; cursor: pointer; transition: 0.2s; 
            font-size: 14px; color: #555;
        }
        .sidebar-item:hover { background: rgba(0,0,0,0.05); }
        .sidebar-item.active { background: var(--accent-color); color: white; }
        .sidebar-item i { margin-right: 8px; width: 16px; text-align: center; }

        .win-content { 
            flex: 1; padding: 15px; overflow-y: auto; 
            display: flex; flex-wrap: wrap; gap: 15px; align-content: flex-start;
        }

        /* ================= Dock æ  ================= */
        #dock { 
            position: fixed; bottom: 0; left: 0; width: 100%; height: 80px; 
            background: rgba(255,255,255,0.9); backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px); border-top: 1px solid rgba(0,0,0,0.1);
            display: flex; justify-content: center; align-items: center; z-index: 1000;
        }
        .dock-item { 
            width: 60px; height: 60px; margin: 0 5px; cursor: pointer; transition: 0.3s; 
            border-radius: 12px; display: flex; align-items: center; justify-content: center;
            font-size: 24px; color: #555;
        }
        .dock-item:hover { transform: scale(1.2); background: rgba(0,0,0,0.1); }
        .dock-item.active { background: var(--accent-color); color: white; }

        /* ================= ç™»å½•ç•Œé¢ ================= */
        #login-screen {
            position: fixed; top:0; left:0; width:100%; height:100%; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex; align-items: center; justify-content: center; z-index: 9999;
        }
        .login-box {
            background: rgba(255,255,255,0.95); backdrop-filter: blur(20px);
            padding: 40px; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            width: 350px; text-align: center;
        }
        .login-input { 
            width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; 
            border-radius: 8px; font-size: 14px;
        }
        .login-btn { 
            width: 100%; padding: 12px; background: var(--accent-color); color: white; 
            border: none; border-radius: 8px; cursor: pointer; font-size: 14px;
        }

        /* ================= å³é”®èœå• ================= */
        .context-menu {
            position: fixed; background: rgba(255,255,255,0.95); backdrop-filter: blur(20px);
            border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); padding: 5px 0;
            z-index: 10000; min-width: 150px; display: none;
        }
        .ctx-item { padding: 8px 15px; cursor: pointer; font-size: 13px; }
        .ctx-item:hover { background: rgba(0,0,0,0.05); }

        /* éšè—å…ƒç´  */
        .hidden { display: none !important; }
        .hidden-input { position: absolute; left: -9999px; }

        /* ç‰¹å®šé¢œè‰² */
        .fa-file-pdf { color: #e74c3c; }
        .fa-file-word { color: #3498db; }
        .fa-file-excel { color: #27ae60; }
        .fa-folder { color: #f1c40f; }
        .fa-youtube { color: #ff0000; }
        .fa-bilibili { color: #fb7299; }

        /* å›¾æ ‡å¤§å° */
        .fa-icon-lg { font-size: 32px; }

        /* æç¤ºæ¡† */
        #toast {
            position: fixed; top: 20px; right: 20px; background: rgba(0,0,0,0.8); 
            color: white; padding: 10px 20px; border-radius: 5px; z-index: 10000;
            display: none;
        }
        #toast.show { display: block; animation: fadeInOut 2s; }
        @keyframes fadeInOut {
            0%,100% { opacity: 0; transform: translateY(-10px); }
            10%,90% { opacity: 1; transform: translateY(0); }
        }

        /* æ¨¡æ€æ¡† */
        .modal {
            position: fixed; top:0; left:0; width:100%; height:100%; 
            background: rgba(0,0,0,0.5); z-index: 10000; display: none;
            align-items: center; justify-content: center;
        }
        .modal-content {
            background: white; padding: 20px; border-radius: 10px; 
            min-width: 400px; max-width: 90%;
        }

        /* ç°ä»£è¾“å…¥æ¡† */
        .modern-input {
            width: 100%; padding: 10px; border: 1px solid #ddd; 
            border-radius: 6px; margin: 5px 0; font-size: 14px;
        }
        .modern-input:focus { outline: none; border-color: var(--accent-color); }

        /* æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ */
        .upload-area {
            border: 2px dashed #ddd; border-radius: 8px; padding: 30px;
            text-align: center; cursor: pointer; transition: 0.3s;
        }
        .upload-area:hover { border-color: var(--accent-color); background: rgba(0,122,255,0.05); }
        .upload-area.dragover { background: rgba(0,122,255,0.1); border-color: var(--accent-color); }
    </style>
</head>
<body>
    <!-- ç™»å½•ç•Œé¢ -->
    <div id="login-screen">
        <div class="login-box">
            <h2 style="color:#333; margin-bottom:30px;">ZMG Cloud OS</h2>
            <input type="text" id="uid" class="login-input" placeholder="ç”¨æˆ·å" value="admin">
            <input type="password" id="pwd" class="login-input" placeholder="å¯†ç " value="admin123">
            <button class="login-btn" onclick="App.handleLogin()">ç™»å½•</button>
        </div>
    </div>

    <!-- æ¡Œé¢åŒºåŸŸ -->
    <div id="desktop">
        <div id="desktop-grid" class="icon-grid"></div>
    </div>

    <!-- Dock æ  -->
    <div id="dock">
        <div class="dock-item" onclick="App.openPC()"><i class="fa-solid fa-desktop"></i></div>
        <div class="dock-item" onclick="App.uploadTrigger()"><i class="fa-solid fa-upload"></i></div>
        <div class="dock-item" onclick="App.uploadFolderTrigger()"><i class="fa-solid fa-folder-plus"></i></div>
        <div class="dock-item" onclick="App.showInstallModal()"><i class="fa-solid fa-gamepad"></i></div>
        <div id="dock-apps"></div>
    </div>

    <!-- å³é”®èœå• -->
    <div class="context-menu" id="context-menu">
        <div class="ctx-item" onclick="App.openSelected()">ğŸ“‚ æ‰“å¼€</div>
        <div class="ctx-item" onclick="App.renameSelected()">âœï¸ é‡å‘½å</div>
        <div class="ctx-item" onclick="App.deleteSelected()" style="color:red">ğŸ—‘ï¸ åˆ é™¤</div>
        <div style="height:1px; background:#ddd; margin:4px 0"></div>
        <div class="ctx-item" onclick="App.showInstallModal()">ğŸ“¥ å®‰è£… H5 åº”ç”¨</div>
        <div class="ctx-item" onclick="App.createFolder()">ğŸ“ æ–°å»ºæ–‡ä»¶å¤¹</div>
    </div>

    <!-- æ–‡ä»¶ä¸Šä¼ è¾“å…¥æ¡† -->
    <input type="file" id="file-input" class="hidden-input" onchange="App.handleUpload(this)">
    <input type="file" id="folder-input" class="hidden-input" webkitdirectory mozdirectory onchange="App.handleUpload(this, true)">
    
    <!-- æç¤ºæ¡† -->
    <div id="toast"></div>

    <!-- åº”ç”¨å®‰è£…æ¨¡æ€æ¡† -->
    <div class="modal" id="install-modal">
        <div class="modal-content">
            <h3>å®‰è£… H5 åº”ç”¨</h3>
            <div style="padding:25px;">
                <div style="text-align:center; margin-bottom:20px; color: #666;">
                    <i class="fa-solid fa-gamepad fa-3x"></i>
                    <p style="font-size:12px; margin-top:10px;">è¯·ä¸Šä¼ åŒ…å« index.html çš„ Zip åŒ…<br>æˆ–ä½¿ç”¨ Dock æ çš„æ–‡ä»¶å¤¹ä¸Šä¼ åŠŸèƒ½</p>
                </div>
                <input type="text" id="h5-name" class="modern-input" placeholder="åº”ç”¨åç§°">
                <input type="file" id="h5-file" accept=".zip" class="modern-input" style="padding: 5px;">
                <div style="margin-top:20px; display:flex; gap:10px;">
                    <button class="modern-input" style="background:#f0f0f0; cursor:pointer;" onclick="document.getElementById('install-modal').style.display='none'">å–æ¶ˆ</button>
                    <button class="modern-input" style="background:var(--accent-color); color:white; cursor:pointer;" onclick="App.installH5App()">å®‰è£…</button>
                </div>
            </div>
        </div>
    </div>

    <script src="./src/main.js"></script>
</body>
</html>